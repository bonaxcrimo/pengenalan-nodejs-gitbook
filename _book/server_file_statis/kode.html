<!DOCTYPE HTML>
<html lang="en-US" manifest="../manifest.appcache">
    
    <head>
        
        <meta charset="UTF-8">
        <title>Kode | Aplikasi Web Node.js</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 0.5.2">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    
    <link rel="next" href="../pemrosesan_data_form_html/README.html" />
    
    
    <link rel="prev" href="../server_file_statis/README.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../gitbook/style.css">


        
    <div class="book"  data-level="4.1" data-basepath=".." data-revision="1403584076841">
    <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    
    <a href="https://github.com/null" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    

    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" >Aplikasi Web Node.js</a>
    </h1>
</div>

    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        

        

        

        

        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
    
        <li class="chapter " data-level="1" data-path="nodejs/README.html">
            
            <a href="../nodejs/README.html">
                <i class="fa fa-check"></i> <b>1.</b> Node.js
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="nodejs/javascript_di_server.html">
            
            <a href="../nodejs/javascript_di_server.html">
                <i class="fa fa-check"></i> <b>1.1.</b> JavaScript Di Server
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="nodejs/nodejs_show.html">
            
            <a href="../nodejs/nodejs_show.html">
                <i class="fa fa-check"></i> <b>1.2.</b> Node.js In Action
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="asinkron_io_&amp;_event/README.html">
            
            <a href="../asinkron_io_&amp;_event/README.html">
                <i class="fa fa-check"></i> <b>2.</b> Asinkron I/O &amp; Event
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="asinkron_io_&amp;_event/php_&amp;_server_http_apache.html">
            
            <a href="../asinkron_io_&amp;_event/php_&amp;_server_http_apache.html">
                <i class="fa fa-check"></i> <b>2.1.</b> PHP &amp; Server HTTP Apache
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="asinkron_io_&amp;_event/javascript_&amp;_nodejs.html">
            
            <a href="../asinkron_io_&amp;_event/javascript_&amp;_nodejs.html">
                <i class="fa fa-check"></i> <b>2.2.</b> Javascript &amp; Node.js
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="server_http_dasar/README.html">
            
            <a href="../server_http_dasar/README.html">
                <i class="fa fa-check"></i> <b>3.</b> Server HTTP Dasar
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="server_http_dasar/menjalankan_server.html">
            
            <a href="../server_http_dasar/menjalankan_server.html">
                <i class="fa fa-check"></i> <b>3.1.</b> Menjalankan Server
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="server_file_statis/README.html">
            
            <a href="../server_file_statis/README.html">
                <i class="fa fa-check"></i> <b>4.</b> Server File Statis
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="server_file_statis/kode.html">
            
            <a href="../server_file_statis/kode.html">
                <i class="fa fa-check"></i> <b>4.1.</b> Kode
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="pemrosesan_data_form_html/README.html">
            
            <a href="../pemrosesan_data_form_html/README.html">
                <i class="fa fa-check"></i> <b>5.</b> Pemrosesan Data Form HTML
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="pemrosesan_data_form_html/url_encoded.html">
            
            <a href="../pemrosesan_data_form_html/url_encoded.html">
                <i class="fa fa-check"></i> <b>5.1.</b> URL Encode
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="pemrosesan_data_form_html/multipart.html">
            
            <a href="../pemrosesan_data_form_html/multipart.html">
                <i class="fa fa-check"></i> <b>5.2.</b> Multipart Data
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="npm/README.html">
            
            <a href="../npm/README.html">
                <i class="fa fa-check"></i> <b>6.</b> Module
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="npm/npm.html">
            
            <a href="../npm/npm.html">
                <i class="fa fa-check"></i> <b>6.1.</b> Konsep
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="npm/konsep.html">
            
            <a href="../npm/konsep.html">
                <i class="fa fa-check"></i> <b>6.2.</b> npm
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" data-path="expressjs/README.html">
            
            <a href="../expressjs/README.html">
                <i class="fa fa-check"></i> <b>7.</b> ExpressJS 
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="picture_uploader/README.html">
            
            <a href="../picture_uploader/README.html">
                <i class="fa fa-check"></i> <b>8.</b> Database
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="9" data-path="database/README.html">
            
            <a href="../database/README.html">
                <i class="fa fa-check"></i> <b>9.</b> Picture Uploader
            </a>
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 52.63157894736842%;min-width: 47.36842105263158%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../nodejs/README.html" title="Node.js" class="chapter done new-chapter" data-progress="1" style="left: 5.2631578947368425%;"></a>
    
        <a href="../nodejs/javascript_di_server.html" title="JavaScript Di Server" class="chapter done " data-progress="1.1" style="left: 10.526315789473685%;"></a>
    
        <a href="../nodejs/nodejs_show.html" title="Node.js In Action" class="chapter done " data-progress="1.2" style="left: 15.789473684210526%;"></a>
    
        <a href="../asinkron_io_&amp;_event/README.html" title="Asinkron I/O &amp; Event" class="chapter done new-chapter" data-progress="2" style="left: 21.05263157894737%;"></a>
    
        <a href="../asinkron_io_&amp;_event/php_&amp;_server_http_apache.html" title="PHP &amp; Server HTTP Apache" class="chapter done " data-progress="2.1" style="left: 26.31578947368421%;"></a>
    
        <a href="../asinkron_io_&amp;_event/javascript_&amp;_nodejs.html" title="Javascript &amp; Node.js" class="chapter done " data-progress="2.2" style="left: 31.57894736842105%;"></a>
    
        <a href="../server_http_dasar/README.html" title="Server HTTP Dasar" class="chapter done new-chapter" data-progress="3" style="left: 36.8421052631579%;"></a>
    
        <a href="../server_http_dasar/menjalankan_server.html" title="Menjalankan Server" class="chapter done " data-progress="3.1" style="left: 42.10526315789474%;"></a>
    
        <a href="../server_file_statis/README.html" title="Server File Statis" class="chapter done new-chapter" data-progress="4" style="left: 47.36842105263158%;"></a>
    
        <a href="../server_file_statis/kode.html" title="Kode" class="chapter done " data-progress="4.1" style="left: 52.63157894736842%;"></a>
    
        <a href="../pemrosesan_data_form_html/README.html" title="Pemrosesan Data Form HTML" class="chapter  new-chapter" data-progress="5" style="left: 57.89473684210526%;"></a>
    
        <a href="../pemrosesan_data_form_html/url_encoded.html" title="URL Encode" class="chapter  " data-progress="5.1" style="left: 63.1578947368421%;"></a>
    
        <a href="../pemrosesan_data_form_html/multipart.html" title="Multipart Data" class="chapter  " data-progress="5.2" style="left: 68.42105263157895%;"></a>
    
        <a href="../npm/README.html" title="Module" class="chapter  new-chapter" data-progress="6" style="left: 73.6842105263158%;"></a>
    
        <a href="../npm/npm.html" title="Konsep" class="chapter  " data-progress="6.1" style="left: 78.94736842105263%;"></a>
    
        <a href="../npm/konsep.html" title="npm" class="chapter  " data-progress="6.2" style="left: 84.21052631578948%;"></a>
    
        <a href="../expressjs/README.html" title="ExpressJS " class="chapter  new-chapter" data-progress="7" style="left: 89.47368421052632%;"></a>
    
        <a href="../picture_uploader/README.html" title="Database" class="chapter  new-chapter" data-progress="8" style="left: 94.73684210526316%;"></a>
    
        <a href="../database/README.html" title="Picture Uploader" class="chapter  new-chapter" data-progress="9" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_23">
                    
                        <h1 id="kode">Kode</h1>
<p>Agar server Node.js bisa mengirimkan file statis ke klien maka server perlu mengetahui <code>path</code> atau tempat dimana file tersebut berada.</p>
<p>Node.js bisa mengirimkan file tersebut secara streaming melalui fungsi <a href="http://nodejs.org/api/fs.html#fs_fs_createreadstream_path_options" target="_blank"><code>fs.createReadStream()</code></a>. Sebelum dijelaskan lebih lanjut mungkin bisa dilihat atau di coba saja server file Node.js dibawah ini</p>
<p><a href="https://raw.github.com/idjs/belajar-nodejs/gh-pages/code/server-file/server-file.js" target="_blank"><code>server-file.js</code></a></p>
<pre><code>var http = require(&#39;http&#39;),
    parse = require(&#39;url&#39;).parse,
    join = require(&#39;path&#39;).join,
    fs = require(&#39;fs&#39;),
    root = join(__dirname, &#39;www&#39;),
    PORT = 3300,

    server = http.createServer(function(req, res){
        var url = parse(req.url),
            path = join(root, url.pathname),
            stream = fs.createReadStream(path);

        stream.on(&#39;data&#39;, function(bagian){
            res.write(bagian);
        });

        stream.on(&#39;end&#39;, function(){
            res.end();
        });

        stream.on(&#39;error&#39;, function(){
            res.setHeader(&#39;Content-Type&#39;,&#39;text/html&#39;);

            var url_demo = &quot;http://localhost:&quot;+PORT+&quot;/index.html&quot;;
            res.write(&quot;coba buka &lt;a href=&quot;+url_demo+&quot;&gt;&quot;+url_demo+&quot;&lt;/a&gt;&quot;);
            res.end();
        })

    });

    server.listen(PORT);
    console.log(&#39;Port &#39;+PORT+&#39;: Server File &#39;);
</code></pre><p>Berikut sedikit penjelasan dari kode diatas</p>
<ul>
<li><a href="http://nodejs.org/api/globals.html#globals_dirname" target="_blank"><code>__dirname</code></a> merupakan variabel global yang disediakan oleh Node.js yang berisi path direktori dari file yang sedang aktif mengeksekusi <code>__dirname</code>.</li>
<li><code>root</code> merupakan direktori root atau referensi tempat dimana file-file yang akan dikirimkan oleh server Node.js. Pada kode server diatas direktori root di setting pada direktori <code>www</code>.</li>
<li><code>path</code> adalah path file yang bisa didapatkan dengan menggabungkan path direktori root dan <code>pathname</code>. <code>pathname</code> yang dimaksud di sini misalnya jika URL yang diminta yaitu <code>http://localhost:3300/index.html</code> maka <code>pathname</code> adalah <code>/index.html</code>. Nilai variabel <code>path</code> dihasilkan dengan memakai fungsi <code>join()</code>.</li>
</ul>
<pre><code>var path = join(root, url.pathname)
</code></pre><ul>
<li><code>stream</code> yang di kembalikan oleh fungsi <code>fs.createReadStream()</code> merupakan class <a href="http://nodejs.org/api/stream.html#stream_class_stream_readable" target="_blank"><code>stream.Readable</code></a>. Objek <code>stream</code> ini mengeluarkan data secara streaming untuk di olah lebih lanjut. Perlu menjadi catatan bahwa <code>stream.Readable</code> tidak akan mengeluarkan data jikalau tidak di kehendaki. Nah...cara untuk mendeteksi data streaming ini sudah siap di konsumsi atau belum adalah melalui event.</li>
</ul>
<p>Event yang di dukung oleh class <code>stream.Readable</code> adalah sebagai berikut</p>
<ul>
<li>Event: <code>readable</code></li>
<li>Event: <code>data</code></li>
<li>Event: <code>end</code></li>
<li>Event: <code>error</code></li>
<li>Event: <code>close</code></li>
</ul>
<p>Mungkin anda bertanya kenapa server file statis diatas memakai metode stream, bukankah menyediakan file secara langsung saja sudah bisa? jawabannya memang bisa tetapi mungkin tidak akan efisien kalau file yang akan di berikan ke client mempunyai ukuran yang cukup besar. Coba lihat kode berikut ini</p>
<pre><code>var http = require(&#39;http&#39;);
var fs = require(&#39;fs&#39;);

var server = http.createServer(function (req, res) {
    fs.readFile(__dirname + &#39;/data.txt&#39;, function (err, data) {
        res.end(data);
    });
});
server.listen(8000);
</code></pre><p>Jika file <code>data.txt</code> ukurannya terlalu besar maka buffer yang digunakan oleh sistem juga besar sehingga konsumsi memori juga akan bertambah besar seiring semakin banyak pengguna yang mengakses file ini.</p>
<p>Jika anda ingin lebih banyak mendalami tentang Node.js Stream silahkan lihat resource berikut (dalam Bahasa Inggris)</p>
<ul>
<li><a href="http://nodejs.org/api/stream.html" target="_blank">Node.js API Stream</a></li>
<li><a href="https://github.com/substack/stream-handbook" target="_blank">Stream Handbook</a></li>
</ul>
<p> <br/></p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../server_file_statis/README.html" class="navigation navigation-prev " aria-label="Previous page: Server File Statis"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../pemrosesan_data_form_html/README.html" class="navigation navigation-next " aria-label="Next page: Pemrosesan Data Form HTML"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
<script src="../gitbook/app.js"></script>

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
